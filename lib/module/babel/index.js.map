{"version":3,"names":["SKIP","Symbol","module","exports","rewire","babel","options","t","types","name","index","mappings","require","visitor","ImportDeclaration","path","node","source","value","replaceWithMultiple","specifiers","reduce","declarations","specifier","mapping","imported","alias","identifier","local","s","importDefaultSpecifier","importNamespaceSpecifier","importSpecifier","push","importDeclaration","stringLiteral","previous","find","d","requeue"],"sources":["index.js"],"sourcesContent":["const SKIP = Symbol('SKIP');\r\n\r\nmodule.exports = function rewire(babel, options) {\r\n  const t = babel.types;\r\n\r\n  const { name, index, mappings } = require(options.mappings ||\r\n    '../../mappings.json');\r\n\r\n  return {\r\n    visitor: {\r\n      ImportDeclaration(path) {\r\n        if (path.node.source.value !== name || path.node[SKIP]) {\r\n          return;\r\n        }\r\n\r\n        path.node.source.value = `${name}/${index}`;\r\n        path.replaceWithMultiple(\r\n          path.node.specifiers.reduce((declarations, specifier) => {\r\n            const mapping = mappings[specifier.imported.name];\r\n\r\n            if (mapping) {\r\n              const alias = `${name}/${mapping.path}`;\r\n              const identifier = t.identifier(specifier.local.name);\r\n\r\n              let s;\r\n\r\n              switch (mapping.name) {\r\n                case 'default':\r\n                  s = t.importDefaultSpecifier(identifier);\r\n                  break;\r\n                case '*':\r\n                  s = t.importNamespaceSpecifier(identifier);\r\n                  break;\r\n                default:\r\n                  s = t.importSpecifier(identifier, t.identifier(mapping.name));\r\n              }\r\n\r\n              declarations.push(\r\n                t.importDeclaration([s], t.stringLiteral(alias))\r\n              );\r\n            } else {\r\n              const previous = declarations.find(\r\n                (d) => d.source.value === path.node.source.value\r\n              );\r\n\r\n              if (previous) {\r\n                previous.specifiers.push(specifier);\r\n              } else {\r\n                const node = t.importDeclaration([specifier], path.node.source);\r\n                node[SKIP] = true;\r\n                declarations.push(node);\r\n              }\r\n            }\r\n\r\n            return declarations;\r\n          }, [])\r\n        );\r\n\r\n        path.requeue();\r\n      },\r\n    },\r\n  };\r\n};\r\n"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,MAAM,CAAC,MAAM,CAAC;AAE3BC,MAAM,CAACC,OAAO,GAAG,SAASC,MAAM,CAACC,KAAK,EAAEC,OAAO,EAAE;EAC/C,MAAMC,CAAC,GAAGF,KAAK,CAACG,KAAK;EAErB,MAAM;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAS,CAAC,GAAGC,OAAO,CAACN,OAAO,CAACK,QAAQ,IACxD,qBAAqB,CAAC;EAExB,OAAO;IACLE,OAAO,EAAE;MACPC,iBAAiB,CAACC,IAAI,EAAE;QACtB,IAAIA,IAAI,CAACC,IAAI,CAACC,MAAM,CAACC,KAAK,KAAKT,IAAI,IAAIM,IAAI,CAACC,IAAI,CAAChB,IAAI,CAAC,EAAE;UACtD;QACF;QAEAe,IAAI,CAACC,IAAI,CAACC,MAAM,CAACC,KAAK,GAAI,GAAET,IAAK,IAAGC,KAAM,EAAC;QAC3CK,IAAI,CAACI,mBAAmB,CACtBJ,IAAI,CAACC,IAAI,CAACI,UAAU,CAACC,MAAM,CAAC,CAACC,YAAY,EAAEC,SAAS,KAAK;UACvD,MAAMC,OAAO,GAAGb,QAAQ,CAACY,SAAS,CAACE,QAAQ,CAAChB,IAAI,CAAC;UAEjD,IAAIe,OAAO,EAAE;YACX,MAAME,KAAK,GAAI,GAAEjB,IAAK,IAAGe,OAAO,CAACT,IAAK,EAAC;YACvC,MAAMY,UAAU,GAAGpB,CAAC,CAACoB,UAAU,CAACJ,SAAS,CAACK,KAAK,CAACnB,IAAI,CAAC;YAErD,IAAIoB,CAAC;YAEL,QAAQL,OAAO,CAACf,IAAI;cAClB,KAAK,SAAS;gBACZoB,CAAC,GAAGtB,CAAC,CAACuB,sBAAsB,CAACH,UAAU,CAAC;gBACxC;cACF,KAAK,GAAG;gBACNE,CAAC,GAAGtB,CAAC,CAACwB,wBAAwB,CAACJ,UAAU,CAAC;gBAC1C;cACF;gBACEE,CAAC,GAAGtB,CAAC,CAACyB,eAAe,CAACL,UAAU,EAAEpB,CAAC,CAACoB,UAAU,CAACH,OAAO,CAACf,IAAI,CAAC,CAAC;YAAC;YAGlEa,YAAY,CAACW,IAAI,CACf1B,CAAC,CAAC2B,iBAAiB,CAAC,CAACL,CAAC,CAAC,EAAEtB,CAAC,CAAC4B,aAAa,CAACT,KAAK,CAAC,CAAC,CACjD;UACH,CAAC,MAAM;YACL,MAAMU,QAAQ,GAAGd,YAAY,CAACe,IAAI,CAC/BC,CAAC,IAAKA,CAAC,CAACrB,MAAM,CAACC,KAAK,KAAKH,IAAI,CAACC,IAAI,CAACC,MAAM,CAACC,KAAK,CACjD;YAED,IAAIkB,QAAQ,EAAE;cACZA,QAAQ,CAAChB,UAAU,CAACa,IAAI,CAACV,SAAS,CAAC;YACrC,CAAC,MAAM;cACL,MAAMP,IAAI,GAAGT,CAAC,CAAC2B,iBAAiB,CAAC,CAACX,SAAS,CAAC,EAAER,IAAI,CAACC,IAAI,CAACC,MAAM,CAAC;cAC/DD,IAAI,CAAChB,IAAI,CAAC,GAAG,IAAI;cACjBsB,YAAY,CAACW,IAAI,CAACjB,IAAI,CAAC;YACzB;UACF;UAEA,OAAOM,YAAY;QACrB,CAAC,EAAE,EAAE,CAAC,CACP;QAEDP,IAAI,CAACwB,OAAO,EAAE;MAChB;IACF;EACF,CAAC;AACH,CAAC"}