{"version":3,"names":["PortalContext","React","createContext","PortalHost","Component","manager","children","key","nextKey","mount","queue","push","type","update","op","index","findIndex","o","unmount","componentDidMount","length","action","pop","render","styles","container","props","setManager","StyleSheet","create","flex"],"sources":["PortalHost.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\n\r\nimport PortalManager from './PortalManager';\r\n\r\nexport type Props = {\r\n\tchildren: React.ReactNode;\r\n};\r\n\r\ntype Operation =\r\n\t| { type: 'mount'; key: number; children: React.ReactNode }\r\n\t| { type: 'update'; key: number; children: React.ReactNode }\r\n\t| { type: 'unmount'; key: number };\r\n\r\nexport type PortalMethods = {\r\n\tmount: (children: React.ReactNode) => number;\r\n\tupdate: (key: number, children: React.ReactNode) => void;\r\n\tunmount: (key: number) => void;\r\n};\r\n\r\nexport const PortalContext = React.createContext<PortalMethods>(null as any);\r\n\r\n/**\r\n * Portal host renders all of its children `Portal` elements.\r\n * For example, you can wrap a screen in `Portal.Host` to render items above the screen.\r\n * If you're using the `Provider` component, it already includes `Portal.Host`.\r\n *\r\n * ## Usage\r\n * ```js\r\n * import * as React from 'react';\r\n * import { Text } from 'react-native';\r\n * import { Portal } from 'react-native-paper';\r\n *\r\n * const MyComponent = () => (\r\n *   <Portal.Host>\r\n *     <Text>Content of the app</Text>\r\n *   </Portal.Host>\r\n * );\r\n *\r\n * export default MyComponent;\r\n * ```\r\n *\r\n * Here any `Portal` elements under `<App />` are rendered alongside `<App />` and will appear above `<App />` like a `Modal`.\r\n */\r\nexport default class PortalHost extends React.Component<Props> {\r\n\tstatic displayName = 'Portal.Host';\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst manager = this.manager;\r\n\t\tconst queue = this.queue;\r\n\r\n\t\twhile (queue.length && manager) {\r\n\t\t\tconst action = queue.pop();\r\n\t\t\tif (action) {\r\n\t\t\t\t// eslint-disable-next-line default-case\r\n\t\t\t\tswitch (action.type) {\r\n\t\t\t\t\tcase 'mount':\r\n\t\t\t\t\t\tmanager.mount(action.key, action.children);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'update':\r\n\t\t\t\t\t\tmanager.update(action.key, action.children);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'unmount':\r\n\t\t\t\t\t\tmanager.unmount(action.key);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setManager = (manager: PortalManager | undefined | null) => {\r\n\t\tthis.manager = manager;\r\n\t};\r\n\r\n\tprivate mount = (children: React.ReactNode) => {\r\n\t\tconst key = this.nextKey++;\r\n\r\n\t\tif (this.manager) {\r\n\t\t\tthis.manager.mount(key, children);\r\n\t\t} else {\r\n\t\t\tthis.queue.push({ type: 'mount', key, children });\r\n\t\t}\r\n\r\n\t\treturn key;\r\n\t};\r\n\r\n\tprivate update = (key: number, children: React.ReactNode) => {\r\n\t\tif (this.manager) {\r\n\t\t\tthis.manager.update(key, children);\r\n\t\t} else {\r\n\t\t\tconst op: Operation = { type: 'mount', key, children };\r\n\t\t\tconst index = this.queue.findIndex(\r\n\t\t\t\t(o) =>\r\n\t\t\t\t\to.type === 'mount' || (o.type === 'update' && o.key === key)\r\n\t\t\t);\r\n\r\n\t\t\tif (index > -1) {\r\n\t\t\t\tthis.queue[index] = op;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queue.push(op as Operation);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tprivate unmount = (key: number) => {\r\n\t\tif (this.manager) {\r\n\t\t\tthis.manager.unmount(key);\r\n\t\t} else {\r\n\t\t\tthis.queue.push({ type: 'unmount', key });\r\n\t\t}\r\n\t};\r\n\r\n\tprivate nextKey = 0;\r\n\tprivate queue: Operation[] = [];\r\n\tprivate manager: PortalManager | null | undefined;\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<PortalContext.Provider\r\n\t\t\t\tvalue={{\r\n\t\t\t\t\tmount: this.mount,\r\n\t\t\t\t\tupdate: this.update,\r\n\t\t\t\t\tunmount: this.unmount,\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{/* Need collapsable=false here to clip the elevations, otherwise they appear above Portal components */}\r\n\t\t\t\t<View\r\n\t\t\t\t\tstyle={styles.container}\r\n\t\t\t\t\tcollapsable={false}\r\n\t\t\t\t\tpointerEvents=\"box-none\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{this.props.children}\r\n\t\t\t\t</View>\r\n\t\t\t\t<PortalManager ref={this.setManager} />\r\n\t\t\t</PortalContext.Provider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\tflex: 1,\r\n\t},\r\n});\r\n"],"mappings":"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"}